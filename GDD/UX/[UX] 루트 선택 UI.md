---
title: 루트 선택 UI
category: UX
parent: [[GDD/시스템/[SYS] 스토리 분기 시스템]]
related:
  - [[GDD/시스템/[SYS] 부대 정비]]
  - [[GDD/시스템/[SYS] 턴제 전투 시스템]]
  - [[GDD/시스템/[SYS] 상태 지속]]
data:
  schema: [[GDD/데이터/[DATA] 데이터 모델 가이드]]
---

## 상위/연관
- 상위: [[GDD/시스템/[SYS] 스토리 분기 시스템]]  
- 연관: [[GDD/시스템/[SYS] 부대 정비]] · [[GDD/시스템/[SYS] 턴제 전투 시스템]] · [[GDD/시스템/[SYS] 상태 지속]] · [[GDD/데이터/[DATA] 데이터 모델 가이드]]

---

## 상세 사양(병합 본문)

## 목적
- 루트 선택 페이지에서 현재 선택 가능한 루트만 활성화하고, 부대 정비를 통해 전투 배치를 준비하는 흐름을 정의한다.

## 핵심 흐름
1) 진입: 스토리 진행에 따라 접근 가능한 루트 목록 생성  
2) 필터: 메인/서브, 지역, 난이도, 인물 태그 필터  
3) 상태 표시: 완료/진행중/미해금/잠금(사유 툴팁)  
4) 활성화 규칙: 조건 충족 루트만 클릭 가능  
5) 부대 정비: 진입 전 파티 구성/배치/장비/소모품 설정  
6) 시작: 확정 팝업(권장 전투력/위험도/소모 예상치) 후 진입

## UI 구성
- 상단: 스토리 타이틀/현재 장면/리소스(골드, 소모품)  
- 본문: 루트 카드 그리드(썸네일, 제목, 요약, 조건/보상 아이콘, 진행도)  
- 우측 패널: 선택한 루트 상세(적 구성, 추천 전열, 예상 보상)  
- 하단: [부대 정비] [시작] 버튼(잠금 시 이유 표기)
- 잠금 표시: 텍스트 + 아이콘 병기, Hover 시 상세 툴팁 노출

### 그래프 뷰(계층형 우향 자동 레이아웃)
- 레이아웃: 우측 방향 계층형(루트 깊이=열, 같은 깊이는 세로 스택).  
- 연결선: 베지어 곡선, 라벨 지원(선택지 텍스트/조건 요약).  
- 노드 상태: 활성/잠금 시각화, 클릭 시 이동(에피소드/전투).  
- 미니맵: 우하단에 표시, 현재 뷰포트 프레임 오버레이.  
- 패닝/줌: 캔버스 드래그(Grab/Grabbing) + 마우스휠 줌.  
- 툴팁: 노드 Hover 시 요약, 잠금 시 사유 노출.
 - 자동 간격: 노드 수에 따라 칼럼/행 간격을 동적으로 보정(최소/최대 한계 설정).  
 - 미니맵 프레임 드래그: 미니맵에서 프레임을 드래그해 즉시 뷰 이동.

### 툴팁 레이아웃(공통 가이드)
- 고정 위치 레이어 사용, 뷰포트 경계 내 자동 위치 보정(좌우/상하 패딩).
- 스타일: 어두운 바탕(#0f1320) + 테두리(#2a3245) + 그림자, 8px 라운드.

## 상호작용 규칙
- 잠금 루트 클릭 시: 툴팁으로 부족 조건 표시(예: 호감도 3 필요)  
- 활성 루트 클릭 시: 상세 패널 업데이트  
- 시작 클릭 시: 조건 재검증 → 부대 정비 완료 여부 확인 → 진입  
- 추천 배치: 현재 보유 캐릭터 기반 자동 편성 제공
- 해당 루트는 도주/퇴각 없음. 진행은 승리로만 가능
 - 그래프 이동: 드래그 패닝, 휠 줌. 미니맵 프레임 드래그(차후)로 뷰 이동.

## 데이터
```json
{
  "routeId": "R-010",
  "title": "폐허 수색",
  "summary": "낡은 사원에서 단서를 수색한다",
  "requirements": [{"type": "flag", "key": "intro.cleared", "value": true}],
  "recommendedPower": 1200,
  "expectedRewards": ["골드", "소모품", "장식품"],
  "enemyPreview": ["해골 병사", "사냥개"],
  "entryCost": {"provision": 1}
}
```

## 권장 전투력 산정(초안)
- 캐릭터 스탯 단순 합/평균 기반 산정(추후 역할/시너지 보정 예정)

## 검증 항목
- 접근 가능한 루트만 활성화  
- 잠금 사유 명확 표기  
- 부대 정비 미완료 시 경고  
- 권장 전투력/위험도 노출
